<h5>All Transaction</h5>
<div class="filters">
    <div class="search-bar">
        <span class="material-symbols-outlined" aria-hidden="true">
            search
        </span>
        <input 
            type="text" 
            placeholder="Search Transactions..."
            aria-label="Search Transactions"
            (input)="searchTerm.set($any($event.target).value)"
        >
    </div>
    <select 
        class="types" 
        aria-label="Filter by transaction type"
        (change)="onChangeType($event)"
    >
        <option value="" selected>All Types</option>
        <option value="1">Income</option>
        <option value="2">Expense</option>
    </select>
    <div class="categories">
        <button 
            class="category-header" 
            aria-label="Filter by categories"
            (click)="toggleModal('category')"
        >
            <p>Categories</p>
            <span class="material-symbols-outlined">
                keyboard_arrow_down
            </span>
        </button>
        <div class="category-modal" [class.open]="modals().category">
            @for (c of categories(); track c.categoryId) {
                <label class="category-option">
                    <input
                        type="checkbox"
                        [value]="c.name"
                        (change)="onCategoryToggle(c.name, $event.target.checked)"
                    />
                {{ c.name }}
                </label>
            }
        </div>
    </div>
    <select 
        class="payment-methods" 
        aria-label="Filter by payment method"
        (change)="onChangePaymentType($event)"
    >
        <option value="" selected>All Payment Method</option>
        <option value="1">Cash</option>
        <option value="2">Credit Card</option>
        <option value="3">Bank Transfer</option>
        <option value="4">Other</option>
    </select>
    <div class="amount">
        <button class="amount-header" (click)="toggleModal('amount')" aria-label="Filter by amount range">
            <p>Amount</p>
            <span class="material-symbols-outlined">
                keyboard_arrow_down
            </span>
        </button>
        <div 
            class="amount-modal" 
            [class.open]="modals().amount" 
            role="dialog"
            aria-label="Amount filter options"
            [attr.aria-hidden]="!modals().amount"]
        >
            <div class="inputs">
                <input 
                    type="number" 
                    placeholder="Min Amount"
                    aria-label="Minimum amount"
                    (input)="minAmount.set($event.target.valueAsNumber || null)">
                <input 
                    type="number" 
                    placeholder="Max Amount"
                    aria-label="Maximum amount"
                    (input)="maxAmount.set($event.target.valueAsNumber || null)">
            </div>
        </div>
    </div>
    <div class="date">
        <button 
            class="date-header" 
            (click)="toggleModal('date')"
            [attr.aria-expanded]="modals().date"
            aria-controls="date-modal"
            aria-label="Filter by date range"
        >
            <span class="material-symbols-outlined">
                calendar_today
            </span>
            <p>Date</p>
        </button>
        <div 
            class="date-modal" 
            role="dialog"
            aria-label="Date filter options"
            [class.open]="modals().date"
            [attr.aria-hidden]="!modals().date"
        >
            <div class="inputs">
                <input 
                    type="date" 
                    placeholder="From"
                    aria-label="Start date"
                    (input)="startDate.set($event.target.value)">
                <input 
                    type="date" 
                    placeholder="To"
                    aria-label="End date"
                    (input)="endDate.set($event.target.value)">
            </div>
        </div>
    </div>
</div>
<table>
    <thead>
        <tr>
            <th>DATE</th>
            <th>TYPE</th>
            <th>CATEGORY</th>
            <th>TRANSACTION</th>
            <th>PAYMENT METHOD</th>
            <th>AMOUNT</th>
            <th>&nbsp;</th>
        </tr>
    </thead>
    <tbody>
        @for(t of transactions(); track t.transactionId) {
            <tr>
                <td>
                    <p>{{ t.transactionDate }}</p>
                </td>
                <td>
                    <p>{{ TransactionTypeMap[t.transactionType] }}</p>
                </td>
                <td>
                    <p>{{ categoryMap().get(t.categoryId) ?? 'Unknown' }}</p>
                </td>
                <td>
                    <p>{{ t.name }}</p>
                </td>
                <td>
                    <p>{{ PaymentTypeMap[t.paymentType] }}</p>
                </td>
                <td>
                    <p 
                        [style.color]="t.transactionType === 1 ? 'green' : 'red'"
                    >
                        {{ t.transactionType == 1 ? '+' : '-'}}{{ t.amount | currency }}
                    </p>
                </td>
                <td>
                    <div class="buttons">
                        <button (click)="onDelete(t.transactionId)">
                            <span class="material-symbols-outlined">
                                delete
                            </span>
                        </button>
                        <button (click)="onEdit(t.transactionId)">
                            <span class="material-symbols-outlined">
                                edit
                            </span>
                        </button>
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>